import { SAT } from './SAT/SAT';
import * as path from 'path';

async function test() {
	const caminho = path.resolve('SAT.dll');
	const sat = new SAT(caminho, 'jclan3411');
	const sessao = Math.floor(Math.random() * 999999);
	const retorno = await sat.enviarDadosVenda(
		sessao,
		'<CFe><infCFe Id="CFe35230411111111111111591234567890000014372785" versao="0.06" versaoDadosEnt="0.02" versaoSB="000003"><ide><cUF>35</cUF><cNF>437278</cNF><mod>59</mod><nserieSAT>123456789</nserieSAT><nCFe>000001</nCFe><dEmi>20230414</dEmi><hEmi>122934</hEmi><cDV>5</cDV><tpAmb>2</tpAmb><CNPJ>11111111111111</CNPJ><signAC>hdj2552244122223335dddd44444d444d4wq4dwddsa4d444d4sa4d4asd44a4444d4sa4d4asd4cscsacsdcdscdsc366sc6s3c3sdc63c3c63c3sd3c3sdc3ds6c3ds3c3dsc3333333333333333cds3c3ds3c3sdc3ds3c3sdc3dsc3ds3c3dsc33ds3cds3c3ds3cc3ds3c3c3ds3c3dsc3ds3c3cds3c3dscc3ds3c3sd3c3c3dsc3ds3c3dsc3ds3cds3c3sdc3sd3c3sdc3sc6sd6cs6dc6sdc6s6c6sdc6sd6c6sdc6sc6sd6csd6c6ds6csd6c66c6ddc</signAC><assinaturaQRCODE>g/yi7cpPeEzaB2ilil/tIJOO+jpo7LfcDNEAXtEcvlP7DrmKtwoRDBqOLTsLMbvB1FtEbXwrHXO1yyng8vyqNhksiTvRy17ttbYpQBi3CwANBZ7YxwHU2WHAg07fan24//xQ2lXQEaG+bLxGKjbG/bILLxtwt9ipSoiO4tiNLCBz5G3mahOwefSQntfU4TsF5T8UJglr8BftcTVzyOYIphfvYAMS9BXPk/xbniz8CsQ4ZqSMjAOfj8ayK0OZjBTOOzuMhA3kfyk8xpDYCGIGjXusECTxd+jP+krsxau23g+wAva6pK9OrMBg5b+QK1hmZnLufwrtjbcBnRIkTQE8QA==</assinaturaQRCODE><numeroCaixa>002</numeroCaixa></ide><emit><CNPJ>11111111111111</CNPJ><xNome>Estabelecimento de Teste 2</xNome><xFant>Estabelecimento Fantasia 2</xFant><enderEmit><xLgr>rua das flores</xLgr><nro>1005</nro><xCpl>frente</xCpl><xBairro>centro</xBairro><xMun>Sao Paulo</xMun><CEP>00000000</CEP></enderEmit><IE>111111111111</IE><IM>123123</IM><cRegTrib>3</cRegTrib><indRatISSQN>N</indRatISSQN></emit><dest/><det nItem="1"><prod><cProd>0001</cProd><cEAN>0012345678905</cEAN><xProd>Trib ICMS Integral Aliquota 10.00% - PIS e COFINS cod 08 sem incidencia</xProd><NCM>41</NCM><CFOP>5001</CFOP><uCom>kg</uCom><qCom>1.0000</qCom><vUnCom>100.00</vUnCom><vProd>100.00</vProd><indRegra>A</indRegra><vItem>100.00</vItem></prod><imposto><ICMS><ICMS00><Orig>0</Orig><CST>00</CST><pICMS>10.00</pICMS><vICMS>10.00</vICMS></ICMS00></ICMS><PIS><PISNT><CST>08</CST></PISNT></PIS><COFINS><COFINSNT><CST>08</CST></COFINSNT></COFINS></imposto></det><total><ICMSTot><vICMS>10.00</vICMS><vProd>100.00</vProd><vDesc>0.00</vDesc><vPIS>0.00</vPIS><vCOFINS>0.00</vCOFINS><vPISST>0.00</vPISST><vCOFINSST>0.00</vCOFINSST><vOutro>0.00</vOutro></ICMSTot><vCFe>100.00</vCFe></total><pgto><MP><cMP>01</cMP><vMP>100.00</vMP></MP><vTroco>0.00</vTroco></pgto></infCFe><Signature xmlns="http://www.w3.org/2000/09/xmldsig#"><SignedInfo><CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/><SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"/><Reference URI="#CFe35230411111111111111591234567890000014372785"><Transforms><Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/><Transform Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/></Transforms><DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"/><DigestValue>N6WUfIj+gTvP3eaDOh9NAZjd2LagbVAtUxgw4x9MY4k=</DigestValue></Reference></SignedInfo><SignatureValue>Rbh7SF3HUyggcrC5djmKInxiV/oq0ABj1xACWosQuwXGCXeJdPUM+iYkQlPJIeYtJJ0uGfpjH40EmGHtwgXWKmmnWAqHJJ8+Wz6b2J4Kx8uB5LsmVtXRsFFg2Mff6Xa2WNqALXamkUGkwcLy7ZjufeIcWx/O4KOGj1bK/fQaGstMYkyIprYijisU2iEaeFC3efy2mVDEEwn8IErG+EkMmeg/Qv8OHg9f1m8Jaez4KZiWtoNQfRH4LYwt0v/W/ygcCHcZ6kjD3h0SIl7MUO1YX6LxfItCkBfdqqYfIoxdDwQ+IqCO8rqqQ0W2pT+su2iV6OJi9+5lzlP3qCNQxhD/AA==</SignatureValue><KeyInfo><X509Data><X509Certificate>MIICyTCCAbGgAwIBAgIIPitDoYMOUaUwDQYJKoZIhvcNAQELBQAwDjEMMAoGA1UEBhMDU0FUMB4XDTIzMDQxNDE1MjQ1OVoXDTI1MDQwMzE1MjQ1OVowDjEMMAoGA1UECwwDU0FUMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAsfRWE5kqsUeTuJGqqTkNXMk40gfVrkWPrcSmfDyFYP0Orq3gRrjyl4bYC/MpfiTAgWS43866mgRJbLL/KPzuEMR+sPYlNpSHjyxdtMNRyksH37XPTrbqsOYZguu67J7B5JGW/uyh4PQhcaeF5d/1xkM4yEhIvnBN44NWBU0iJKPwTfWiku55HgIxb43Mjd5y5NXvoEwdGf4xFh2sEFQ44nz7cIlj33H9hc0boMGV4QRejAp+QxsfyfgrD25M3a9pz0wrhPz10jTasPqwdk5J3BLzcs8rmmj+723RE1DZKo3AozMryqJggoh2OsMN9m0seZcU9QC8fsoa7zta1b1LTQIDAQABoyswKTAnBgNVHREEIDAeoBwGCCsGAQUFBwgFoBAMDnd3dy5zYXQuY29tLmJyMA0GCSqGSIb3DQEBCwUAA4IBAQCPR+UtdkccVp4EFEZETGJMtmmQRdY8p5bxc2/QrxoeEzPld7ZR8QC1jz2GxUOVnoSTeOFfhb9kDaZ9yVF7TEnFq9QYmkh+S5lpTB0tJvr73TxqkcaR7PwBlZ5D9G8BqN7Ez4kmwQThvB8QMNmr4rawcvoQIxE27U9VnTnf88K1MNdeN30Xoxjeiv4TPAjcfTrV/wt8STvuyeqkElYud0slEnFu/lamHdYDecSMhjYbyNTLjXhX+ERZGBknPfhcZ9g8LDFTEHew24oNTRw6krLp8OEo46FhPjpByF5+R625la3Dle38/DMom5/G3PkWsXOWy0rEQ4CRSHtJaUnpEf5J</X509Certificate></X509Data></KeyInfo></Signature></CFe>'
	);
	console.log(retorno);
}

test();
